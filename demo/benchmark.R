#obs <- sapply(1:100, function(x){rnorm(1, (-3)*x, 1)})
obs <- c(-2.62975709208799, -5.35574732246581, -9.85585801059848, -12.7263431947122, 
         -11.7727657739384, -19.621138645009, -20.7523656426202, -23.4846874609267, 
         -26.4157145914377, -27.331329537307, -31.9027667364839, -35.338473382034, 
         -39.3540803968125, -42.5685277877906, -45.7718365999674, -47.263195582811, 
         -51.1339810639587, -54.5587628775699, -55.6619351353008, -61.4886633779034, 
         -62.1102522261655, -66.23810593803, -68.3645552658784, -71.9057943074615, 
         -75.7537966877416, -77.6374977105757, -80.9608354689272, -83.4579208324749, 
         -86.8785100359958, -90.5099987408929, -92.3308948636456, -97.0967070787976, 
         -98.3005664936518, -101.808960489728, -105.320415632234, -107.577638122696, 
         -112.392860624578, -113.435263636376, -117.82486391607, -120.504030402702, 
         -122.541502402283, -126.567687259546, -129.200341938223, -130.093396480491, 
         -135.267419470768, -139.059985453517, -142.397276400528, -144.15499755313, 
         -147.355144775354, -152.051225250467, -152.853834249998, -156.573050522512, 
         -159.54785239546, -163.082699346144, -167.213937921237, -168.380668933454, 
         -171.002053071293, -173.602037149615, -178.893505313647, -180.312037147614, 
         -183.660490093188, -186.44892068397, -188.947230977995, -191.640659630112, 
         -194.756737328378, -197.164609186816, -202.056967592105, -204.183940287683, 
         -206.300827155428, -209.04682504605, -211.638908592714, -215.542298611103, 
         -216.510138149236, -222.077262037361, -223.06396664428, -227.934409215795, 
         -230.224624985941, -234.481392713546, -238.90867944671, -241.82399292856, 
         -243.333632228873, -246.794247043378, -250.103480613581, -253.63884389924, 
         -255.803382477884, -258.875006500321, -261.681506066072, -261.952175556065, 
         -266.283505846475, -270.177196300745, -273.217123990876, -274.63587406381, 
         -278.33697062821, -283.648872037629, -284.483298145515, -287.627774065363, 
         -291.814351961144, -293.432900685228, -298.048454951964, -301.722339431354
)

timeL <- system.time(
  out <- LazyABC(obs, 
                 rimport = function(){rnorm(1, 5, 5)}, 
                 dimport = function(x){dnorm(x, 5, 5)}, 
                 prior = function(x){dunif(x, 0, 10)}, 
                 simInit = function(x){rnorm(1, (x+2)*(x-2), 1)}, 
                 simCont = function(theta, x){
                   c(x, data <- sapply(2:100, function(x){rnorm(1, (theta+2)*(theta-2)*x, 1)}))
                 }, 
                 alpha = function(theta, x){if(abs(x + 2.63) < 1){1} else {0.1}}, tol = 1000, n = 10000)
)
dataL <- out[out$weight > 0,]

estimateL <- sum(dataL$weight*dataL$theta)/sum(dataL$weight)
ESSL <- (sum(dataL$weight)^2)/sum(dataL$weight^2)


timeI <- system.time(
  out <- ImportanceABC(obs, 
                       rimport = function(){rnorm(1, 5, 5)}, 
                       dimport = function(x){dnorm(x, 5, 5)}, 
                       prior = function(x){dunif(x, 0, 10)},  
                       simulator = function(theta){
                         data <- sapply(1:100, function(x){rnorm(1, (theta+2)*(theta-2)*x, 1)})
                       }, tol = 1000, n = 10000)
)
dataI <- out[out$weight > 0,]

estimateI <- sum(dataI$weight*dataI$theta)/sum(dataI$weight)
ESSI <- (sum(dataI$weight)^2)/sum(dataI$weight^2)

output <- data.frame("Time" = c(timeL[3], timeI[3]), "ESS" = c(ESSL, ESSI), "Estimate" = c(estimateL, estimateI))
row.names(output) <- c("Lazy ABC", "Importance ABC")
output